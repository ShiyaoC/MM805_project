% i = 4;
% in_fn_test = fullfile(image_root_dir, strcat(dblm.rel_filenames{i}, '.jpg'));
% in_img = imread(in_fn_test);
in_img = imread("../images/test3.jpg");
load(['models/m170306_dlib2_xm2.mat']);
load(['../test.mat']);
addpath(genpath('code'));

% imshow(in_img)
B = reshape(arr',1,numel(arr));
lm = B;
% lm = dblm.data(i,:)+1;
[out_img, res] = regfunc_fanc_do_normalization(in_img, lm, model);

figure(1);

subplot(121);
imshow(in_img); hold on; plot(lm(1:2:end), lm(2:2:end), 'g.'); hold off;
title('Input image with landmarks');

subplot(122); 
imshow(out_img);
title('Result of frontalization');